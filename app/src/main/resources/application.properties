spring.main.banner-mode=off
logging.config=classpath:logback-spring.xml

# server
server.shutdown=graceful
server.error.include-message=always
server.compression.enabled=true
server.compression.mime-types=application/json

# reactive
spring.codec.max-in-memory-size=100MB

# actuators
management.endpoints.web.exposure.include=prometheus,health
# actuator - health
management.endpoint.health.probes.enabled=true
management.endpoint.health.show-components=always
management.endpoint.health.show-details=always
management.health.diskspace.enabled=false
# actuator - metrics
management.endpoint.prometheus.enabled=true
management.prometheus.metrics.export.enabled=true
management.metrics.enable.http.client.requests=false

# safselvbetjening
safselvbetjening.tidligst-innsyn-dato=2016-06-04

# circuitbreaker
resilience4j.circuitbreaker.configs.default.register-health-indicator=true
resilience4j.circuitbreaker.configs.default.sliding-window-size=20
resilience4j.circuitbreaker.configs.default.sliding-window-type=count_based
resilience4j.circuitbreaker.configs.default.minimum-number-of-calls=15
resilience4j.circuitbreaker.configs.default.permitted-number-of-calls-in-half-open-state=2
resilience4j.circuitbreaker.configs.default.automatic-transition-from-open-to-half-open-enabled=true
resilience4j.circuitbreaker.configs.default.wait-duration-in-open-state=30s
resilience4j.circuitbreaker.configs.default.failure-rate-threshold=50
resilience4j.circuitbreaker.configs.default.record-exceptions=org.springframework.web.client.HttpServerErrorException,no.nav.safselvbetjening.consumer.ConsumerTechnicalException,org.springframework.web.client.ResourceAccessException
resilience4j.circuitbreaker.configs.default.ignore-exceptions=no.nav.safselvbetjening.consumer.ConsumerFunctionalException
resilience4j.circuitbreaker.instances.arkivsak.base-config=default
resilience4j.circuitbreaker.instances.pdl.base-config=default
resilience4j.circuitbreaker.instances.pdl.sliding-window-size=100
resilience4j.circuitbreaker.instances.pdl.minimum-number-of-calls=75
resilience4j.circuitbreaker.instances.pdl.permitted-number-of-calls-in-half-open-state=10
resilience4j.circuitbreaker.instances.pensjonbrukerforsak.base-config=default
resilience4j.circuitbreaker.instances.pensjonpensjonssaker.base-config=default
resilience4j.circuitbreaker.instances.fagarkiv.base-config=default
resilience4j.circuitbreaker.instances.fagarkivhentdokument.base-config=default
resilience4j.circuitbreaker.instances.fagarkivhentdokument.sliding-window-size=50
resilience4j.circuitbreaker.instances.fagarkivhentdokument.minimum-number-of-calls=25
resilience4j.circuitbreaker.instances.fagarkivhentdokument.permitted-number-of-calls-in-half-open-state=5
resilience4j.circuitbreaker.instances.fagarkivhentdokument.wait-duration-in-open-state=5m
resilience4j.circuitbreaker.instances.fagarkivtilgangjournalpost.base-config=default

# retry
resilience4j.retry.configs.default.max-attempts=3
resilience4j.retry.configs.default.wait-duration=500ms
resilience4j.retry.configs.default.enable-exponential-backoff=true
resilience4j.retry.configs.default.exponential-backoff-multiplier=2
resilience4j.retry.configs.default.retry-exceptions=org.springframework.web.client.HttpServerErrorException,no.nav.safselvbetjening.consumer.ConsumerTechnicalException,org.springframework.web.client.ResourceAccessException
resilience4j.retry.configs.default.ignore-exceptions=no.nav.safselvbetjening.consumer.ConsumerFunctionalException
resilience4j.retry.instances.arkivsak.base-config=default
resilience4j.retry.instances.pdl.base-config=default
resilience4j.retry.instances.pensjon.base-config=default
resilience4j.retry.instances.azuretoken.base-config=default

# kafka
spring.kafka.properties.ssl.truststore.type=JKS
spring.kafka.properties.ssl.keystore.type=PKCS12
spring.kafka.properties.security.protocol=SSL
spring.kafka.properties.ssl.truststore.location=${KAFKA_TRUSTSTORE_PATH}
spring.kafka.properties.ssl.keystore.location=${KAFKA_KEYSTORE_PATH}
spring.kafka.properties.ssl.truststore.password=${KAFKA_CREDSTORE_PASSWORD}
spring.kafka.properties.ssl.keystore.password=${KAFKA_CREDSTORE_PASSWORD}
spring.kafka.properties.ssl.key.password=${KAFKA_CREDSTORE_PASSWORD}

spring.kafka.bootstrap-servers=${KAFKA_BROKERS}
spring.kafka.properties.schema.registry.url=${KAFKA_SCHEMA_REGISTRY}
spring.kafka.properties.basic.auth.credentials.source=USER_INFO
spring.kafka.properties.basic.auth.user.info=${KAFKA_SCHEMA_REGISTRY_USER}:${KAFKA_SCHEMA_REGISTRY_PASSWORD}
# producer
spring.kafka.producer.acks=all
spring.kafka.producer.properties.max.block.ms=5000
spring.kafka.producer.properties.enable.idempotence=true
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=io.confluent.kafka.serializers.KafkaAvroSerializer
